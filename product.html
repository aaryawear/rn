<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Rozana Needs</title>

<style>
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:#f4f6f9}
.wrap{max-width:420px;margin:auto;padding:12px}
img{width:100%;border-radius:16px}
h2{margin:10px 0 4px}
.price{font-size:22px;font-weight:800;color:#16a34a}
.btn{width:100%;padding:16px;border:none;border-radius:14px;background:#000;color:#fff;margin-top:10px;font-size:16px}
.badge{font-size:12px;color:#6b7280;margin:6px 0}
.loader{text-align:center;padding:40px;color:#6b7280}
.info{background:#fff;border-radius:12px;padding:10px;margin-top:10px;font-size:13px}
</style>
</head>

<body>

<div class="wrap">

<div id="loading" class="loader">Loading productâ€¦</div>

<div id="content" style="display:none">

<img id="img">
<h2 id="name"></h2>

<div class="badge">â­ Rozana Needs Verified â€¢ COD Available â€¢ Fast Dispatch</div>

<div class="price">â‚¹<span id="price"></span></div>

<div class="info">
ğŸšš Delivery in 2â€“5 days<br>
ğŸ”„ Easy replacement if damaged<br>
ğŸ“² WhatsApp support after order
</div>

<button class="btn" id="buy">Buy Now</button>

</div>

</div>

<script>
const SHEET_ID = "1g5iU3kc5iEBhnQNUlEXKlUIh25rVsdoBN7fRQYG0Xh0";
const pid = new URLSearchParams(location.search).get("id");

/* ELEMENTS */
const imgEl = document.getElementById("img");
const nameEl = document.getElementById("name");
const priceEl = document.getElementById("price");
const buyBtn = document.getElementById("buy");
const loading = document.getElementById("loading");
const content = document.getElementById("content");

fetch(`https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`)
.then(r=>r.text())
.then(t=>{
  const j = JSON.parse(t.substring(47).slice(0,-2));
  const row = j.table.rows[pid-2];

  if(!row){
    alert("Product not found");
    return;
  }

  const name = row.c[0]?.v || "";
  const price = row.c[1]?.v || 0;
  const img = row.c[2]?.v || "";

  imgEl.src = img;
  nameEl.innerText = name;
  priceEl.innerText = price;

  loading.style.display = "none";
  content.style.display = "block";

  buyBtn.onclick = () => {
    location.href = `checkout.html?product=${encodeURIComponent(name)}&price=${price}`;
  };
})
.catch(()=>{
  loading.innerText = "Failed to load product. Check Sheet ID.";
});
</script>

</body>
</html>
