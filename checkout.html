<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Secure Checkout â€¢ Rozana Needs</title>

<style>
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:#f4f6f9}
header{background:#000;color:#fff;padding:12px;text-align:center}
.trust{background:#fff;padding:8px;font-size:12px;display:flex;justify-content:space-around;border-bottom:1px solid #eee}
.wrap{max-width:420px;margin:auto;padding:12px}
.card{background:#fff;border-radius:16px;padding:18px;box-shadow:0 6px 20px rgba(0,0,0,.08)}
h2{margin:0 0 6px}
.summary{background:#f9fafb;border-radius:12px;padding:12px;margin-bottom:12px}
.price{font-size:18px;font-weight:800;color:#16a34a}
input{width:100%;padding:12px;border-radius:10px;border:1px solid #d1d5db;margin-bottom:8px}
.payrow{display:flex;align-items:center;gap:10px;margin:10px 0}
.payrow img{width:48px;height:48px;border-radius:8px}
button{width:100%;padding:14px;border:none;border-radius:12px;background:#000;color:#fff;font-size:16px}
button:disabled{opacity:.6}
.loader{margin:12px auto;border:4px solid #eee;border-top:4px solid #000;border-radius:50%;width:32px;height:32px;animation:spin 1s linear infinite;display:none}
@keyframes spin{100%{transform:rotate(360deg)}}
.note{font-size:12px;color:#6b7280;margin-top:10px;text-align:center}
footer{text-align:center;font-size:12px;color:#6b7280;padding:14px}
</style>
</head>

<body>

<header>ðŸ”’ Secure Checkout â€” Rozana Needs</header>

<div class="trust">
  <div>ðŸšš 2â€“5 Days Delivery</div>
  <div>ðŸ’µ COD Available</div>
  <div>ðŸ”„ Easy Returns</div>
</div>

<div class="wrap">
  <div class="card">

    <h2>Checkout</h2>

    <div class="summary">
      <div id="productName"></div>
      <div class="price">â‚¹<span id="price"></span></div>
      <div style="font-size:12px;color:#6b7280">Order ID: <span id="orderId"></span></div>
    </div>

    <input id="name" placeholder="Full Name *">
    <input id="phone" placeholder="Mobile Number *">
    <input id="address" placeholder="House / Street / Area *">
    <input id="city" placeholder="City *">
    <input id="state" placeholder="State *">
    <input id="pincode" placeholder="Pincode *">

    <!-- PAYMENT OPTIONS -->
    <div class="payrow">
      <input type="radio" name="pay" value="UPI" checked>
      <b>Pay Online (UPI)</b>
      <!-- ðŸ”¥ GIF beside Pay Online -->
      <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExbWZlNnR2Z2o1Z3l0N3J2d2x0N2t2bG1qOGZxN2l4cGx1dG1qYyZlcD12MV9naWZzX3NlYXJjaCZjdD1n/3o7TKtnuHOHHUjR38Y/giphy.gif">
    </div>

    <div class="payrow">
      <input type="radio" name="pay" value="COD">
      <b>Cash on Delivery</b>
    </div>

    <button id="payBtn">Place Order</button>
    <div id="loader" class="loader"></div>

    <div class="note">
      ðŸ”’ 100% Secure Checkout â€¢ WhatsApp support after order<br>
      By placing order you agree to our return/refund policy.
    </div>

  </div>
</div>

<footer>
  Rozana Needs â€¢ Trusted Daily Essentials
</footer>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyAcokjcwR2WEiis__c61TuXEzYXhxUlKB8",
  authDomain:"shop-template-7d574.firebaseapp.com",
  projectId:"shop-template-7d574"
});
const db=firebase.firestore();
</script>

<script>
/* CONFIG */
const UPI_ID="7381749483@okbizaxis";
const STORE_NAME="Rozana Needs";
const TELEGRAM_BOT="8519147037:AAGXDo9ku4iOP6X6F2jQxnME08WwctUjoj0";
const TELEGRAM_CHAT="5820261983";

/* PRODUCT */
const q=new URLSearchParams(location.search);
const product=q.get("product")||"Product";
const price=q.get("price")||"0";
const orderId="RN"+Date.now().toString().slice(-8);

productName.innerText=product;
priceEl= document.getElementById("price");
priceEl.innerText=price;
orderIdEl=document.getElementById("orderId");
orderIdEl.innerText=orderId;

/* TELEGRAM */
function sendTG(m){
 fetch(`https://api.telegram.org/bot${TELEGRAM_BOT}/sendMessage?chat_id=${TELEGRAM_CHAT}&text=${encodeURIComponent(m)}`).catch(()=>{});
}

payBtn.onclick=async()=>{
 const name=nameEl=name.value, phoneVal=phone.value, addr=address.value, c=city.value, s=state.value, p=pincode.value;
 if(!name||!phoneVal||!addr||!c||!s||!p) return alert("Please fill all required fields");

 const method=document.querySelector("input[name=pay]:checked").value;

 payBtn.disabled=true;
 loader.style.display="block";

 await db.collection("orders").add({
   orderId,
   product,
   amount:Number(price),
   customerName:name,
   phone:phoneVal,
   address:addr,
   city:c,
   state:s,
   pincode:p,
   paymentMethod:method,
   status:method==="COD"?"COD_PENDING":"PENDING",
   createdAt:firebase.firestore.FieldValue.serverTimestamp()
 });

 sendTG(`ðŸ›’ New Order\n${orderId}\n${product}\nâ‚¹${price}\n${method}\n${phoneVal}`);

 if(method==="COD"){
   setTimeout(()=>location.href=`success.html?orderId=${orderId}&cod=1`,2500);
   return;
 }

 /* Open UPI app */
 location.href=`upi://pay?pa=${UPI_ID}&pn=${STORE_NAME}&am=${price}&cu=INR&tn=${orderId}`;

 /* Show processing then success */
 setTimeout(()=>location.href=`success.html?orderId=${orderId}`,15000);
};
</script>

</body>
</html>
